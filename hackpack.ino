#include "application.h"
#include <string.h>
#include <stdint.h>
#include "neopixel.h"
#include "cmd.h"
#include "pixel_grid.h"
#include "states.h"

//*****************************************
//We have some particle specific stuff here
PRODUCT_ID(3920);
PRODUCT_VERSION(8);
SYSTEM_MODE(SEMI_AUTOMATIC);

//*********************************************************************************
// Put your custom lighting sequence here, it can be an animation or a static image
// Display it by texting 'animate custom' to your device
// Color Format is 24-bit RGB (written in hex)
//*********************************************************************************
uint32_t custom_animation_lut[][16] = {
  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00},   //Frame1

  { 0xff9900,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00},
    
  { 0xffa31a,0xff9900,0xb36b00,0xb36b00,
    0xff9900,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00},
    
  { 0xb35900,0xffa31a,0xff9900,0xb36b00,
    0xffa31a,0xff9900,0xb36b00,0xb36b00,
    0xff9900,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00},
    
  { 0xb33c00,0xb35900,0xffa31a,0xff9900,
    0xffad33,0xffa31a,0xff9900,0xb36b00,
    0xffa31a,0xff9900,0xb36b00,0xb36b00,
    0xff9900,0xb36b00,0xb36b00,0xb36b00},
    
  { 0x990000,0xb33c00,0xffad33,0xffa31a,
    0xe68a00,0xffad33,0xb35900,0xff9900,
    0xffad33,0xffa31a,0xff9900,0xb36b00,
    0xffa31a,0xff9900,0xb36b00,0xb36b00},
    
  { 0xb33c00,0x990000,0xe68a00,0xffad33,
    0xb36b00,0xe68a00,0xb33c00,0xb35900,
    0xe68a00,0xffad33,0xffa31a,0xff9900,
    0xffad33,0xffa31a,0xff9900,0xb36b00},
    
  { 0xb36b00,0xb33c00,0xb36b00,0xe68a00,
    0xb36b00,0xb36b00,0x990000,0xb33c00,
    0xb36b00,0xe68a00,0xffad33,0xffa31a,
    0xe68a00,0xffad33,0xffa31a,0xff9900},

  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb33c00,0x990000,
    0xb36b00,0xb36b00,0xe68a00,0xffad33,
    0xb36b00,0xe68a00,0xffad33,0xffa31a},
    
  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb33c00,
    0xb36b00,0xb36b00,0xb36b00,0xe68a00,
    0xb36b00,0xb36b00,0xe68a00,0xffad33},
    
  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xe68a00},

// Dead frames

  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00},
    
  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00},
    
  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00},
    
  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00},
    
  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00},
    
  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00},
    
  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00},
    
  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00},
    
  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00},
    
  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00},
    
  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00},
    
  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00},
    
  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00},
    
  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00},

  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00},

  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00},

  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00},
    
  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb35900,0xb36b00,0xb36b00},

  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb35900,0xb36b00,0xb36b00,
    0xb36b00,0xb33c00,0xb36b00,0xb36b00},
    
  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb35900,0xb36b00,0xb36b00,
    0xb36b00,0xb33c00,0xb36b00,0xb36b00},

  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb35900,0xb36b00,0xb36b00,
    0xb36b00,0xb33c00,0xb36b00,0xb36b00},

  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb35900,0xb36b00,0xb36b00,
    0xb36b00,0xb33c00,0xb36b00,0xb36b00},

  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb33c00,0xb35900,0xb36b00,
    0xb36b00,0x990000,0xb36b00,0xb36b00},
    
  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb35900,
    0xb36b00,0x990000,0xb33c00,0xb36b00,
    0xb36b00,0xb33c00,0xb36b00,0xb36b00},

  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb35900,
    0xb36b00,0x990000,0xb33c00,0xb36b00,
    0xb36b00,0xb33c00,0xb36b00,0xb36b00},

  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb35900,
    0xb36b00,0x990000,0xb33c00,0xb36b00,
    0xb36b00,0xb33c00,0xb36b00,0xb36b00},

  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb33c00,
    0xb36b00,0xb33c00,0x990000,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00},
    
  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0x990000,
    0xb36b00,0xb36b00,0xb33c00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00},
    
  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb33c00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00},

  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb33c00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00},

  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00},
    
  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00},
    
  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00},
    
  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00},
    
  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00},
    
  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00},
    
  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00},
    
  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00},
    
  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00},
    
  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00},
    
  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00},
    
  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00},
    
  { 0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00,
    0xb36b00,0xb36b00,0xb36b00,0xb36b00}

};

uint16_t custom_animation_length = (sizeof(custom_animation_lut) / sizeof(custom_animation_lut[0]));    //The number of frames in the above array
uint16_t custom_animation_framerate = 100;                                                              //Time (in mS) between frames - Feel free to tweak this!

//*********************************************************************************
// Put your custom lighting sequence here, it can be an animation or a static image
// Display it by texting 'animate custom' to your device
// Color Format is 24-bit RGB (written in hex)
//*********************************************************************************
uint32_t rain_animation_lut[][16] = {
  { 0x4286f4,0x000000,0x000000,0x000000,
    0x000000,0x000000,0x000000,0x000000,
    0x000000,0x000000,0x000000,0x000000,
    0x000000,0x000000,0x000000,0x000000},

  { 0x000000,0x000000,0x000000,0x000000,
    0x4286f4,0x000000,0x000000,0x000000,
    0x000000,0x000000,0x000000,0x000000,
    0x000000,0x000000,0x000000,0x000000},

  { 0x000000,0x000000,0x4286f4,0x000000,
    0x000000,0x000000,0x000000,0x000000,
    0x4286f4,0x000000,0x000000,0x000000,
    0x000000,0x000000,0x000000,0x000000},

  { 0x000000,0x000000,0x000000,0x000000,
    0x000000,0x000000,0x4286f4,0x000000,
    0x000000,0x000000,0x000000,0x000000,
    0x4286f4,0x000000,0x000000,0x000000},

  { 0x000000,0x000000,0x000000,0x000000,
    0x000000,0x000000,0x000000,0x000000,
    0x000000,0x000000,0x4286f4,0x000000,
    0x000000,0x000000,0x000000,0x000000},

  { 0x000000,0x000000,0x000000,0x4286f4,
    0x000000,0x000000,0x000000,0x000000,
    0x000000,0x000000,0x000000,0x000000,
    0x000000,0x000000,0x4286f4,0x000000},

  { 0x000000,0x000000,0x000000,0x000000,
    0x000000,0x000000,0x000000,0x4286f4,
    0x000000,0x000000,0x000000,0x000000,
    0x000000,0x000000,0x000000,0x000000},

  { 0x000000,0x000000,0x000000,0x000000,
    0x000000,0x000000,0x000000,0x000000,
    0x000000,0x000000,0x000000,0x4286f4,
    0x000000,0x000000,0x000000,0x000000},

  { 0x000000,0x4286f4,0x000000,0x000000,
    0x000000,0x000000,0x000000,0x000000,
    0x000000,0x000000,0x000000,0x000000,
    0x000000,0x000000,0x000000,0x4286f4},

  { 0x000000,0x000000,0x000000,0x000000,
    0x000000,0x4286f4,0x000000,0x000000,
    0x000000,0x000000,0x000000,0x000000,
    0x000000,0x000000,0x000000,0x000000},

  { 0x000000,0x000000,0x000000,0x000000,
    0x000000,0x4286f4,0x000000,0x000000,
    0x000000,0x000000,0x000000,0x000000,
    0x000000,0x000000,0x000000,0x000000},

  { 0x000000,0x000000,0x000000,0x000000,
    0x000000,0x000000,0x000000,0x000000,
    0x000000,0x4286f4,0x000000,0x000000,
    0x000000,0x000000,0x000000,0x000000},

  { 0x000000,0x000000,0x000000,0x000000,
    0x000000,0x000000,0x000000,0x000000,
    0x000000,0x000000,0x000000,0x000000,
    0x000000,0x4286f4,0x000000,0x000000}
    
};

uint16_t rain_animation_length = (sizeof(rain_animation_lut) / sizeof(rain_animation_lut[0]));    //The number of frames in the above array
uint16_t rain_animation_framerate = 100;   

//****************************************************************************************
//Our setup function runs once on power up of the Hackpack it initialises the whole system
void setup()
{
    init_system();

    block_scale = 1;
    block_glow = 0;
    block_jitter = 0;
}

//***************************************************************************
//Our loop function runs in a loop all the time while our Hackpack is powered
void loop()
{
    update_display();
}
